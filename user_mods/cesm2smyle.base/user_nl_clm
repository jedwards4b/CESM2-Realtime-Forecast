!---------------------------------------------------------------------------------
! Users should add all user specific namelist changes below in the form of 
! namelist_var = new_namelist_value 
!
! EXCEPTIONS: 
! Set use_cndv           by the compset you use and the CLM_BLDNML_OPTS -dynamic_vegetation setting
! Set use_vichydro       by the compset you use and the CLM_BLDNML_OPTS -vichydro           setting
! Set use_cn             by the compset you use and CLM_BLDNML_OPTS -bgc  setting
! Set use_crop           by the compset you use and CLM_BLDNML_OPTS -crop setting
! Set spinup_state       by the CLM_BLDNML_OPTS -bgc_spinup      setting
! Set irrigate           by the CLM_BLDNML_OPTS -irrig           setting
! Set co2_ppmv           with CCSM_CO2_PPMV                      option
! Set dtime              with L_NCPL                             option
! Set fatmlndfrc         with LND_DOMAIN_PATH/LND_DOMAIN_FILE    options
! Set finidat            with RUN_REFCASE/RUN_REFDATE/RUN_REFTOD options for hybrid or branch cases
!                        (includes $inst_string for multi-ensemble cases)
! Set maxpatch_glcmec    with GLC_NEC                            option
! Set glc_do_dynglacier  with GLC_TWO_WAY_COUPLING               env variable
!----------------------------------------------------------------------------------

!----------------------------------------------------------------------------------
! crop harvest bug fix
!----------------------------------------------------------------------------------

dribble_crophrv_xsmrpool_2atm = .true. 

!----------------------------------------------------------------------------------
!----------------------------------------------------------------------------------

use_init_interp = .true.

!----------------------------------------------------------------------------------
! Trendy SMYLE landuse and surface dataset
!----------------------------------------------------------------------------------
 flanduse_timeseries = '$DIN_LOC_ROOT/lnd/clm2/surfdata_map/release-clm5.0.31/landuse.timeseries_0.9x1.25_hist_78pfts_TRENDY_simyr1700-2019_c200803.nc'
 fsurdat = '$DIN_LOC_ROOT/lnd/clm2/surfdata_map/release-clm5.0.24/surfdata_0.9x1.25_hist_78pfts_TRENDY_simyr1700_c190814.nc'

!----------------------------------------------------------------------------------
! SMYLE extend model align year
!----------------------------------------------------------------------------------

 model_year_align_ndep = 1850
 stream_year_first_ndep = 1850
 stream_year_last_ndep = 2100

 model_year_align_popdens = 1850
 stream_year_first_popdens = 1850
 stream_year_last_popdens = 2100

 model_year_align_urbantv = 1850
 stream_year_first_urbantv = 1850
 stream_year_last_urbantv = 2100


!----------------------------------------------------------------------------------
! Settings from output_base
!----------------------------------------------------------------------------------

! h0 stream (monthly average, gridcell-level)
! h0 stream ICE variables and other variables inactive by default (monthly average, gridcell-level)
! Emon, Lmon, LIMon
hist_mfilt(1) = 1
hist_dov2xy(1) = .true.
hist_nhtfrq(1) = 0
hist_type1d_pertape(1) = ' '
hist_fexcl1 += 'PCT_GLC_MEC','PCT_NAT_PFT'

hist_fincl1 += 'EFLX_LH_TOT_ICE', 'FIRE_ICE', 'FLDS_ICE', 'FSH_ICE', 'FSNO_ICE', 'FSR_ICE', 'QFLX_SUB_SNOW_ICE', 'QRUNOFF_ICE', 'QSNOFRZ_ICE', 'QSNOMELT_ICE', 'DWT_CONV_CFLUX_PATCH'
           'RAIN_ICE', 'SNOW_ICE', 'SNOWICE_ICE', 'SNOWLIQ_ICE', 'SNOTXMASS_ICE', 'TG_ICE', 'TOPO_COL_ICE', 'TSA_ICE', 'TSOI_ICE', 'TKE1', 'QRGWL', 
	   'SABG', 'FIRE', 'FLDS', 'FIRA', 'FSH', 'EFLX_LH_TOT', 'FGR', 'FSM', 'UST_LAKE','TLAKE'

! h1 stream (monthly average, finest sub-grid)
! Emon, Lmon 
hist_mfilt(2) = 1
hist_dov2xy(2) = .false.
hist_nhtfrq(2) = 0
hist_type1d_pertape(2) = ' '
hist_fincl2 += 'TLAI', 'TSA','TREFMNAV','TREFMXAV', 'BTRANMN', 'Vcmx25Z', 'FSH', 'VEGWP', 'FCTR', 'FCEV', 'FGEV', 'FIRE', 'FSR', 'FIRA', 'FSA', 'GSSUNLN', 'GSSHALN', 'TSKIN'

! h2 stream (monthly average, landunit-level)
! Emon
hist_mfilt(3) = 1
hist_dov2xy(3) = .false.
hist_nhtfrq(3) = 0
hist_type1d_pertape(3) = 'LAND'
hist_fincl3 += 'FSR', 'H2OSNO', 'Q2M', 'SNOWDP', 'TSA', 'TREFMNAV', 'TREFMXAV', 'TG', 'FSH', 'FIRE', 'FIRA', 'FGR', 'EFLX_LH_TOT', 'RH2M', 'TLAI', 'SOILWATER_10CM', 'TOTSOILLIQ', 'TOTSOILICE', 'U10', 'TSOI_10CM', 'QIRRIG', 'URBAN_HEAT', 'WASTEHEAT', 'TSKIN','FSA','FSM','HIA','HUMIDEX','SoilAlpha_U','SWBGT','TBUILD','URBAN_AC','URBAN_HEAT','WASTEHEAT','SABG','FLDS'

! h3 stream (yearly average, gridcell-level)
! Eyr
! (No fields for SMYLE)
hist_mfilt(4) = 1
hist_dov2xy(4) = .true.
hist_nhtfrq(4) = 8760
hist_type1d_pertape(4) = ' '
!hist_fincl4 += 'PCT_GLC_MEC', 'QICE_FORC', 'TSRF_FORC', 'TOPO_FORC', 'PCT_NAT_PFT','PCT_LANDUNIT','FSNO_ICE'

! h4 stream (yearly average, landunit-level)
! Eyr landuse tiles
! (No fields in base, but other usermods add to this stream)
hist_mfilt(5) = 1
hist_dov2xy(5) = .false.
hist_nhtfrq(5) = 8760
hist_type1d_pertape(5) = 'LAND'

! h5 stream - one file per month
hist_mfilt(6) = 730
!----------------------------------------------------------------------------------
! Settings from output_bgc
!----------------------------------------------------------------------------------

! h0 stream (monthly average, gridcell-level)
hist_fexcl1 += 'SOIL1C_vr', 'SOIL1N_vr', 'SOIL2C_vr', 'SOIL2N_vr', 'SOIL3C_vr', 'SOIL3N_vr', 'SOILC_vr','SOILN_vr', 'CWDC_vr', 'LITR1C_vr', 'LITR2C_vr', 'LITR3C_vr', 'LITR1N_vr', 'LITR2N_vr', 'LITR3N_vr', 'CWDN_vr', 'SMIN_NO3_vr', 'CONC_O2_UNSAT', 'CONC_O2_SAT','SMIN_NH4_vr','SMINN_vr'
hist_fincl1 += 'LEAFC_TO_LITTER', 'FROOTC_TO_LITTER','LITR1C_TO_SOIL1C','LITR1N_TO_SOIL1N','LITR2C_TO_SOIL1C', 'LITR2N_TO_SOIL1N','LITR3C_TO_SOIL2C','LITR3N_TO_SOIL2N','DWT_WOOD_PRODUCTC_GAIN_PATCH','HR'

! h1 stream (monthly average, finest sub-grid)
hist_fincl2 += 'GPP', 'NPP', 'TOTVEGC', 'NPP_NUPTAKE', 'AR', 'HTOP'

! h2 stream (monthly average, landunit-level)
! TOT_WOODPRODC:I, CROPPROD1C:I, and NEE are not available at the landunit level
hist_fincl3 += 'GPP', 'NPP', 'HR', 'DWT_CONV_CFLUX_PATCH', 'WOOD_HARVESTC', 'DWT_WOOD_PRODUCTC_GAIN_PATCH', 'SLASH_HARVESTC', 'COL_FIRE_CLOSS', 'DWT_SLASH_CFLUX', 'FROOTC:I', 'HTOP'

! h3 stream (yearly average, gridcell-level)
!hist_fincl4 += 'SOILC_vr', 'SOILN_vr', 'CWDC_vr', 'LITR1C_vr', 'LITR2C_vr', 'LITR3C_vr', 'LITR1N_vr', 'LITR2N_vr', 'LITR3N_vr','CWDN_vr', 'TOTLITC:I', 'TOT_WOODPRODC:I', 'TOTSOMC:I','TOTVEGC:I','SOIL1C_vr','SOIL2C_vr','SOIL3C_vr'


!----------------------------------------------------------------------------------
! Settings from output_crop
!----------------------------------------------------------------------------------

! h0 stream (monthly average, gridcell-level)
hist_fexcl1 += 'PCT_CFT'

! h1 stream (monthly average, finest sub-grid)
hist_fincl2 += 'GRAINC_TO_FOOD','NFERTILIZATION','QVEGT','QIRRIG'

! h2 stream (monthly average, landunit-level)
hist_fincl3 += 'GRAINC_TO_FOOD'

! h3 stream (yearly average, gridcell-level)
!hist_fincl4 += 'PCT_CFT','CROPPROD1C:I'

!----------------------------------------------------------------------------------
! Settings from cmip6_carbon_isotopes
!----------------------------------------------------------------------------------

use_c13 = .false.
use_c14 = .false.
!use_c13_timeseries = .true.
!use_c14_bombspike = .true.

! h0 stream (monthly average, gridcell-level)
! hist_fexcl1 += 'C14_SOILC_vr'
! h3 stream (yearly average, gridcell-level)
! hist_fincl4 += 'C14_SOILC_vr'

!----------------------------------------------------------------------------------
! Additional output for CESM2-LE
!----------------------------------------------------------------------------------

 hist_dov2xy(6) = .true.
 hist_dov2xy(7) = .false.
 hist_dov2xy(8) = .true.
 hist_dov2xy(9) = .false.

! h5 stream (daily average, gridcell-level)
 hist_fincl6 = 'SOILWATER_10CM','TOTSOILLIQ', 'TOTSOILICE', 'FGR12', 'QSNOEVAP', 'TLAI', 'QDRAI',
         'QDRAI_PERCH', 'QOVER', 'QFLX_SUB_SNOW', 'FSA', 'H2OSNO', 'SNOCAN', 'QSNOFRZ', 'QFLX_SNOW_DRAIN', 'SNOWDP',
         'H2OSFC', 'TV', 'TG', 'TAUX', 'TAUY', 'QVEGT', 'TWS', 'H2OCAN', 'QVEGE', 'QSOIL',
         'TSKIN', 'FSDS', 'FSNO', 'SNOFSRVD', 'SNOFSRVI', 'SNOFSRND', 'SNOFSRNI', 'FSDSVD', 'FSDSVI', 'FSDSND',
         'FSDSNI', 'SNOWLIQ', 'QINTR', 'SNOBCMSL', 'SNOTXMASS', 'SNOWICE', 
         'QRUNOFF', 'RAIN', 'SNOW', 'GPP', 'NPP', 'AR', 'HR', 'ALT', 'FAREA_BURNED', 'NFIRE','LAKEICETHICK',
         'NBP','NEP','JCONVECT:X','QRGWL','EFLX_GRND_LAKE','UST_LAKE','BTRANMN','TSOI_10CM','CPHASE',
	 'FSR','FSDSVDLN','FSRVDLN','FSDSNDLN','FSRNDLN','FSDSVI', 'FSRVI','FSDSNI','FSRNI','FSH','FCTR','FCEV','FGEV',
         'SOILICE', 'SOILLIQ', 'H2OSOI'
! removed from hist_fincl6 'TSOI','TLAKE' 
! adding for comet hist_fincl6:  'SOILICE', 'SOILLIQ', 'H2OSOI'

! h6 stream (daily average, landunit-level)
 hist_fincl7 = 'TREFMXAV', 'TREFMNAV', 'WBT:X', 'WBT:M', 'HIA:X', 'HIA:M', 'RH2M', 'QRUNOFF'


! h7 stream (3-hourly average, gridcell-level)
! No fields for SMYLE
! hist_fincl8 = 'PBOT', 'TSA', 'RH2M', 'WBT'

! h8 stream (daily average, PFT-level)
 hist_fincl9 = 'CPHASE', 'GPP', 'TLAI', 'AR'

 hist_mfilt(6) = 365
 hist_mfilt(7) = 365
! hist_mfilt(8) = 2920
 hist_mfilt(9) = 365

 hist_nhtfrq(6) = -24
 hist_nhtfrq(7) = -24
! hist_nhtfrq(8) = -3
 hist_nhtfrq(9) = -24

 hist_type1d_pertape(6) = ' '
 hist_type1d_pertape(7) = 'LAND'
! hist_type1d_pertape(8) = ' '
 hist_type1d_pertape(9) = ' '

!----------------------------------------------------------------------------------
! Settings from cmip6_glaciers_virtual_antarctica
!----------------------------------------------------------------------------------

! This differs from the default in that it turns on virtual columns over Antarctica
! This is desired so that we have the output needed to drive a later offline CISM Antarctica simulation
! However, this increases the cost of CLM by about 10%
glacier_region_behavior = 'single_at_atm_topo', 'virtual', 'virtual', 'virtual'


!----------------------------------------------------------------------------------
! SMYLE Modifications
!----------------------------------------------------------------------------------
!! h0 fincl1
hist_fexcl1 += 'CH4_SURF_AERE_SAT','CH4_SURF_AERE_UNSAT','CH4_SURF_DIFF_SAT','CH4_SURF_DIFF_UNSAT',
'CH4_SURF_EBUL_SAT', 'CH4_SURF_EBUL_UNSAT','CPHASE','H2OSOI', 'HR_vr', 'LITR1C', 'LITR1C_TO_SOIL1C', 'LITR1N',
'LITR1N_TO_SOIL1N', 'LITR2C', 'LITR2C_TO_SOIL1C', 'LITR2N', 'LITR2N_TO_SOIL1N', 'LITR3C', 'LITR3C_TO_SOIL2C',
'LITR3N', 'LITR3N_TO_SOIL2N', 'PCT_LANDUNIT', 'SOIL1C', 'SOIL1N', 'SOIL2C', 'SOIL2N', 'SOIL3C', 'SOIL3N', 'SOILICE',
'SOILLIQ', 'TLAKE', 'TOTSOILICE', 'TOTSOILLIQ', 'TSOI', 'TSOI_ICE', 'VEGWP', 
!! h0
hist_fincl1 += 'DWT_CONV_CFLUX_PATCH', 'PCT_CFT', 'QICE_FORC', 'SoilAlpha_U', 'TOPO_FORC', 'TSRF_FORC'

!----------------------------------------------------------------------------------
!! h4 fincl5	Removing this stream
!----------------------------------------------------------------------------------
! h4 stream (yearly average, landunit-level)
! hist_fincl5 += 'TOTSOMC:I', 'TOTSOMC_1m:I', 'TOTECOSYSC:I', 'TOTVEGC:I', 'WOODC:I', 'TOTLITC:I', 'LIVECROOTC:I', 'DEADCROOTC:I', 'FROOTC:I'

!----------------------------------------------------------------------------------
!! h5 fincl6
!----------------------------------------------------------------------------------
!! h5
hist_fexcl6 += 'BTRANMN', 'CPHASE', 'EFLX_GRND_LAKE', 'FAREA_BURNED', 'FCEV', 'FCTR', 'FGEV', 'FSDSNDLN', 'FSDSVDLN',
	'FSDSVI', 'FSR', 'FSRNDLN', 'FSRNI', 'FSRVDLN', 'FSRVI', 'SNOWICE', 'TSOI', 'UST_LAKE'
!! removed 'SOILICE', 'SOILLIQ' from the fexcl list for comet runs, and added them to the fincl6 list above

!! h5
hist_fincl6 += 'EFLX_LH_TOT', 'FGR', 'FIRA', 'FIRE', 'FLDS', 'FSM', 'SABG', 'TKE1', 'TREFMNAV', 'TREFMXAV'

!----------------------------------------------------------------------------------
!! From L32 settings
!----------------------------------------------------------------------------------

&ndepdyn_nml
 model_year_align_ndep = 1850
 ndep_taxmode = 'cycle'
 ndep_varlist = 'NDEP_month'
 ndepmapalgo = 'bilinear'
 stream_fldfilename_ndep = '/cw3e/mead/projects/csg100/cesm/inputdata/lnd/clm2/ndepdata/fndep_clm_f09_g17.CMIP6-SSP3-7.0-WACCM_1849-2101_monthly_c191007.nc'
 stream_year_first_ndep = 1850
 stream_year_last_ndep = 2100
/
&popd_streams
 model_year_align_popdens = 1850
 popdensmapalgo = 'bilinear'
 stream_fldfilename_popdens = '/cw3e/mead/projects/csg100/cesm/inputdata/lnd/clm2/firedata/clmforc.Li_2018_SSP3_CMIP6_hdm_0.5x0.5_AVHRR_simyr1850-2100_c181205.nc'
 stream_year_first_popdens = 1850
 stream_year_last_popdens = 2100
/


